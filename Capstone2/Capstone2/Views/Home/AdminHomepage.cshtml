@{
    ViewData["Title"] = "Admin Homepage";
}

<div class="d-flex" style="min-height: 100vh;">
    <!-- Sidebar -->
    <nav class="p-3 border-end" style="width: 250px; min-height: 100vh; background: #fff; position: fixed; left: 0; top: 0;">
        <h4 class="mb-4 text-dark">Admin Panel</h4>
        <ul class="nav flex-column">
            <li class="nav-item mb-2">
                <a class="nav-link text-dark sidebar-link" href="#" data-url="/Customers/AdminPartial"> <i class="bi bi-card-list me-2"></i> Customer Orders </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link text-dark sidebar-link" href="#" data-url="/HeadWaiters/AdminPartial"> <i class="bi bi-person-badge me-2"></i> HeadWaiters </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link text-dark sidebar-link" href="#" data-url="/Materials/AdminPartial"> <i class="bi bi-box-seam me-2"></i> Materials </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link text-dark sidebar-link" href="#" data-url="/Menus/AdminPartial"> <i class="bi bi-list-ul me-2"></i> Menus </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link text-dark sidebar-link" href="#" data-url="/MenuPackages/AdminPartial"> <i class="bi bi-bag-check me-2"></i> Menu Packages </a>
            </li>
            <li class="nav-item mb-2">
                <a class="nav-link text-dark sidebar-link" href="#" data-url="/Suppliers/AdminPartial"> <i class="bi bi-truck me-2"></i> Suppliers </a>
            </li>
        </ul>
    </nav>
    <!-- Main Content -->
    <div class="flex-grow-1 p-5 bg-light" style="margin-left: 250px;">
        <div id="main-content">
            <!-- Content will be loaded here -->
        </div>
    </div>
</div>

<!-- Bootstrap Icons CDN -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />

@section Scripts {
    <script>
        function loadContent(url, method = 'GET', data = null) {
            const options = { method: method };
            if (method === 'POST' && data) {
                options.headers = { 'Content-Type': 'application/x-www-form-urlencoded' };
                options.body = data;
            }
            fetch(url, options)
                .then(response => response.text())
                .then(html => {
                    document.getElementById('main-content').innerHTML = html;
                });
        }
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                loadContent(this.getAttribute('data-url'));
            });
        });
        // Load default content (Customer Orders) on page load
        window.onload = function () {
            loadContent('/Customers/AdminPartial');
        };

        // Delegate events for links and forms inside #main-content
        document.addEventListener('click', function (e) {
            // Intercept anchor clicks inside #main-content
            const anchor = e.target.closest('#main-content a');
            if (anchor && anchor.getAttribute('href') && !anchor.hasAttribute('download') && anchor.getAttribute('target') !== '_blank' && anchor.getAttribute('href').charAt(0) === '/') {
                e.preventDefault();
                loadContent(anchor.getAttribute('href'));
            }
        });
        document.addEventListener('submit', function (e) {
            // Intercept form submissions inside #main-content
            const form = e.target.closest('#main-content form');
            if (form) {
                e.preventDefault();
                const formData = new URLSearchParams(new FormData(form)).toString();
                let url = form.getAttribute('action') || window.location.pathname;
                let method = (form.getAttribute('method') || 'GET').toUpperCase();
                if (method === 'GET') {
                    url += (url.indexOf('?') === -1 ? '?' : '&') + formData;
                    loadContent(url, 'GET');
                } else {
                    loadContent(url, 'POST', formData);
                }
            }
        });
    </script>
} 